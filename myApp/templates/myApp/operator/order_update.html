{% extends 'operator_base.html' %}
{% load crispy_forms_tags %}

{% block title %}{% endblock %}





{% block dashboard %}
    <div class="pagetitle">
        <h1>Order</h1>

    </div><!-- End Page Title -->
{% endblock %}

{% block content %}
    <div class="col-lg-6">
        <div class="card">
            <div class="card-body">
                <form class="row g-3" method="post" id="personForm" data-cities-url="{% url 'ajax_load_cities' %}">
                    {% csrf_token %}
                    {#                    {{ form|crispy }}#}

                    <div class="col-md-6">
                        <label for="id_add_phone_number"></label>
                        <input type="text" name="add_phone_number" value="" class="form-control" maxlength="15"
                               id="id_add_phone_number" placeholder="Add Phone Number">
                    </div>
                    <div class="col-md-6">
                        <label for="id_first_name"></label>
                        <input type="text" name="first_name" value="" class="form-control" maxlength="50"
                               id="id_first_name" placeholder="First Name">
                    </div>
                    <div class="col-md-6">
                        <label for="id_last_name"></label>
                        <input type="text" name="last_name" value="" class="form-control" maxlength="50"
                               id="id_last_name" placeholder="Last Name">
                    </div>
                    <div class="col-md-6">
                        <label for="id_province"></label>
                        <select name="province" class="form-select" id="id_province">
                            <option value="" selected>---------</option>
                            <option value="3">Andijon viloyati</option>
                            <option value="4">Buxoro viloyati</option>
                            <option value="5">Fargʻona viloyati</option>
                            <option value="6">Jizzax viloyati</option>
                            <option value="7">Xorazm viloyati</option>
                            <option value="8">Namangan viloyati</option>
                            <option value="9">Navoiy viloyati</option>
                            <option value="10">Qashqadaryo viloyati</option>
                            <option value="11">Qoraqalpogʻiston Respublikasi</option>
                            <option value="12">Samarqand viloyati</option>
                            <option value="13">Sirdaryo viloyati</option>
                            <option value="14">Surxondaryo viloyati</option>
                            <option value="15">Toshkent viloyati</option>


                        </select>
                    </div>
                    <div class="col-md-6">
                        <label for="id_region"></label>
                        <select name="region" class="form-select" id="id_region">
                            <option value="" selected>---------</option>

                        </select>
                    </div>
                    <div class="col-md-6">
                        <label for="id_business_name"></label>
                        <input type="text" name="business_name" maxlength="100" class="form-control"
                               id="id_business_name" placeholder="Business Name">
                    </div>
                    <div class="col-md-12">
                        <label for="id_business_type"></label>
                        <select name="business_type" class="form-select" id="id_business_type">
                            <option value="" selected>---------</option>

                            <option value="business">Biznes Reja</option>

                            <option value="teo">TEO</option>

                            <option value="grand">Grand</option>

                            <option value="boshqa">Boshqa</option>

                            <option value="qiziqmadi">Qiziqish bo&#x27;lmadi</option>

                        </select>

                    </div>
                    <div class="col-md-12">
                        <label for="id_quality"></label>
                        <select name="quality" class="form-select" id="id_quality">
                            <option value="">---------</option>

                            <option value="narx">Narx</option>

                            <option value="sifat">Sifat</option>

                            <option value="narx+sifat">Narx + Sifat</option>

                        </select>

                    </div>
                    <div class="col-md-12">
                        <label for="id_price"></label>
                        <input type="text" name="price" value="0" class="form-control" required id="id_price">
                    </div>

                    <script>
                        function numberWithSpaces(x) {
                            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
                        }

                        let telEl = document.querySelector('#id_price');
                        telEl.addEventListener('keyup', (e) => {
                            let val = e.target.value.replace(/\s+/g, '');
                            e.target.value = numberWithSpaces(val);
                        })

                    </script>


                    <div class="col-md-4">
                        <p>
                            <button class="btn btn-primary" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapseWidthExample" aria-expanded="false"
                                    aria-controls="collapseWidthExample">
                                Color
                            </button>
                        </p>
                        <div class="collapse collapse-horizontal" id="collapseWidthExample">
                            <div class="card card-body" style="width: 300px;">
                                <div id="id_color_type">
                                    <div class="row" style="margin-top: 3%; margin-bottom: 3%">
                                        <div class="col-sm-4">
                                            <label class="btn btn-outline-success " for="id_color_type_0">
                                                <input type="radio" name="color_type" value="green" maxlength="15"
                                                       id="id_color_type_0">
                                                <i class="bi bi-emoji-smile" style="font-size: 4rem"></i>
                                            </label>

                                        </div>
                                        <div class="col-sm-4">
                                            <label class="btn btn-outline-warning" for="id_color_type_1">
                                                <input type="radio" name="color_type" value="yellow" maxlength="15"
                                                       id="id_color_type_1">
                                                <i class="bi bi-emoji-frown" style="font-size: 4rem"></i></label>

                                        </div>
                                        <div class="col-sm-4">
                                            <label class="btn btn-outline-danger" for="id_color_type_2">
                                                <input type="radio" name="color_type" value="red" checked maxlength="15"
                                                       id="id_color_type_2"/>
                                                <i class="bi bi-emoji-angry-fill" style="font-size: 4rem"></i>
                                            </label>

                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-8">
                        <p>
                            <button class="btn btn-primary" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapseWidthExample1" aria-expanded="false"
                                    aria-controls="collapseWidthExample">
                                Paid
                            </button>
                        </p>
                        <div class="collapse collapse-horizontal" id="collapseWidthExample1">
                            <div class="card card-body col-sm-10">
                                <label for="id_payme">Payme:</label>
                                <input type="text" name="payme" class="form-control" maxlength="50" id="id_payme">
                                <label for="id_stat_date">Stat date:</label>
                                <input type="datetime-local" name="stat_date" value="" class="form-control"
                                       id="id_stat_date">
                                <label for="id_end_date">End date:</label>
                                <input type="datetime-local" name="end_date" value="" class="form-control"
                                       id="id_end_date">
                            </div>
                        </div>

                    </div>


                    <div class="text-center">
                        <input class="btn btn-primary" id="submitBtn" type="submit" value="band qilish">

                        {#                        <button type="reset" class="btn btn-secondary">Reset</button>#}
                    </div>


                </form>
            </div>


            <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
            <script>

                const formElement = document.querySelector('#personForm');
                const priceField = document.querySelector('#id_price');
                document.querySelector('#submitBtn').addEventListener('click', (e) => {
                    priceField.value = parseInt(priceField.value.replace(/\s/g, ''));
                    console.log('ckeck form', priceField.value);
                    formElement.submit()
                })


                $("#id_province").change(function () {
                    const url = $("#personForm").attr("data-cities-url");  // get the url of the `load_cities` view
                    const provinceId = $(this).val();  // get the selected country ID from the HTML input

                    $.ajax({                       // initialize an AJAX request
                        url: url,                    // set the url of the request (= /persons/ajax/load-cities/ )
                        data: {
                            'province_id': provinceId       // add the country id to the GET parameters
                        },
                        success: function (data) {   // `data` is the return of the `load_cities` view function
                            $("#id_region").html(data);  // replace the contents of the city input with the data that came from the server
                            /*

                            let html_data = '<option value="">---------</option>';
                            data.forEach(function (city) {
                                html_data += `<option value="${city.id}">${city.name}</option>`
                            });
                            console.log(html_data);
                            $("#id_city").html(html_data);

                            */
                        }
                    });

                });
            </script>
        </div>

    </div>







{% endblock %}